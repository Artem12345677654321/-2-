<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLATO RUG | TEXTURAL REVEAL P-37</title>
    
    <style>
        /* –ë–∞–∑–æ–≤—ã–π —Å–±—Ä–æ—Å –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ */
        body { margin: 0; overflow-x: hidden; background-color: #050505; color: #E0E0E0; cursor: none; font-family: 'Times New Roman', serif; }
        :root {
            --color-background: #050505;
            --color-text: #E0E0E0;
            --color-accent: #A08A6F; /* –ó–æ–ª–æ—Ç–∏—Å—Ç–æ-–±—Ä–æ–Ω–∑–æ–≤—ã–π */
            --font-family-serif: 'Times New Roman', serif;
        }

        /* WebGL –•–æ–ª—Å—Ç */
        #webgl-canvas { 
            position: fixed; 
            top: 0; left: 0; 
            z-index: 0; 
            display: block; 
            opacity: 0; /* JS –≤–∫–ª—é—á–∏—Ç –µ–≥–æ —Å—Ä–∞–∑—É –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ "Live" */
            filter: blur(8px); /* –ù–∞—á–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç—É—Ä–Ω—ã–π –±–ª—é—Ä */
            transform: scale(1.1);
        }

        /* HTML –ö–æ–Ω—Ç–µ–Ω—Ç */
        #content {
            position: relative;
            z-index: 10;
        }
        
        .section {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 3em;
            text-align: center;
            padding: 0 10%;
            pointer-events: none; /* –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∫–ª–∏–∫–∏ –∫ –∫–∞–Ω–≤–∞—Å—É */
            box-sizing: border-box; 
        }
        .section > * {
            pointer-events: auto;
        }
        .section h1 { 
            color: #fff; 
            margin-bottom: 0.2em; 
            text-transform: uppercase; 
            font-weight: 100;
            letter-spacing: 0.05em;
            text-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .section p { 
            font-size: 0.4em; 
            max-width: 600px; 
            color: rgba(255,255,255,0.7); 
            line-height: 1.6;
            font-family: Arial, sans-serif;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }
        .interactive-target { cursor: none; display: inline-block; padding-bottom: 5px; border-bottom: 1px solid var(--color-accent); transition: color 0.3s; }
        .interactive-target:hover { color: var(--color-accent); border-color: #fff; }

        /* –ö–∞—Å—Ç–æ–º–Ω—ã–π –ö—É—Ä—Å–æ—Ä */
        .cursor-outer, .cursor-inner {
            pointer-events: none;
            position: fixed;
            z-index: 9999;
            border-radius: 50%;
            top: 0; left: 0;
            transform: translate(-50%, -50%);
        }
        .cursor-outer {
            width: 40px; height: 40px;
            border: 1px solid rgba(160, 138, 111, 0.5);
            mix-blend-mode: exclusion;
        }
        .cursor-inner {
            width: 6px; height: 6px;
            background-color: var(--color-accent);
        }

        /* üî• –°—Ç–∏–ª–∏ –ü—Ä–µ–ª–æ–∞–¥–µ—Ä–∞ P-37: Textural Reveal */
        #loader-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: transparent; /* P-37: –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –∂–∏–≤–æ–π 3D —Ñ–æ–Ω */
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(2px); /* –õ–µ–≥–∫–∞—è –¥—ã–º–∫–∞ –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –ª–æ–≥–æ */
        }
        
        .loader-content-wrap {
            text-align: center;
            width: 100%;
            overflow: visible;
        }

        .loader-logo-split {
            font-family: var(--font-family-serif);
            color: var(--color-accent);
            font-size: 3em; 
            letter-spacing: 0.2em;
            display: flex;
            justify-content: center;
            white-space: nowrap;
            opacity: 0; 
            text-transform: uppercase;
            text-shadow: 0 20px 40px rgba(0,0,0,0.8); /* –¢–µ–Ω—å –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ —Å 3D */
        }

        .logo-left, .logo-right {
            display: inline-block;
            position: relative;
            will-change: transform, opacity;
        }

        /* –≠–ª–µ–≥–∞–Ω—Ç–Ω–∞—è –ª–∏–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
        #loader-bar-container {
            width: 150px;
            height: 1px;
            background-color: rgba(160, 138, 111, 0.2);
            margin: 30px auto 0;
            overflow: hidden;
            opacity: 0; 
        }
        
        #loader-bar {
            height: 100%;
            width: 100%;
            background-color: var(--color-accent);
            transform: scaleX(0); 
            transform-origin: left center;
        }
    </style>
    
    <!-- Scripts (Global CDN) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script type="importmap">
    {
      "imports": {
        "react": "https://aistudiocdn.com/react@^19.2.1",
        "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.1/",
        "react/": "https://aistudiocdn.com/react@^19.2.1/",
        "three": "https://aistudiocdn.com/three@^0.181.2",
        "gsap": "https://aistudiocdn.com/gsap@^3.13.0",
        "gsap/": "https://aistudiocdn.com/gsap@^3.13.0/"
      }
    }
    </script>
</head>
<body>
    <!-- Preloader P-37 Structure -->
    <div id="loader-overlay">
        <div class="loader-content-wrap">
            <div class="loader-logo-split">
                <!-- P-37 Split: PLATO | RUG -->
                <span class="logo-left">PLATO</span><span class="logo-right">RUG</span>
            </div>
            <div id="loader-bar-container">
                <div id="loader-bar"></div>
            </div>
        </div>
    </div>

    <canvas id="webgl-canvas"></canvas>
    
    <div class="cursor-outer"></div>
    <div class="cursor-inner"></div>
    
    <div id="content">
        <!-- Section 1: Hero Pinning -->
        <div class="section" id="section-1">
            <h1>PLATO RUG</h1>
            <p>–ü–µ—Ä–µ–æ—Å–º—ã—Å–ª–µ–Ω–∏–µ –∫–æ–≤—Ä–æ—Ç–∫–∞—á–µ—Å—Ç–≤–∞. <br>–ò—Å–∫—É—Å—Å—Ç–≤–æ, –ø–æ–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –≤ <span class="interactive-target">—Ü–∏—Ñ—Ä–æ–≤—É—é —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å</span>.</p>
        </div>
        
        <!-- Section 2 -->
        <div class="section" id="section-2">
            <h1>–ë–µ—Å—à–æ–≤–Ω—ã–π –î–∏–∑–∞–π–Ω</h1>
            <p>–ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Ç–µ–∫—Å—Ç—É—Ä—ã, –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ —Ç–µ–Ω–∏. <br>–ù–∞—à–∏ 3D-–º–æ–¥–µ–ª–∏ ‚Äî —ç—Ç–æ –∞–±—Å–æ–ª—é—Ç–Ω—ã–π <span class="interactive-target">—Ñ–æ—Ç–æ—Ä–µ–∞–ª–∏–∑–º</span> –≤ –±—Ä–∞—É–∑–µ—Ä–µ.</p>
        </div>
        
        <!-- Section 3 -->
        <div class="section" id="section-3">
            <h1>–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –°—é–∂–µ—Ç</h1>
            <p>–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π —Å –ø–æ–º–æ—â—å—é –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–∞. <br>–ö–∞–∂–¥–∞—è <span class="interactive-target">–¥–µ—Ç–∞–ª—å</span> –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ.</p>
        </div>
    </div>
    
    <script>
        // ==========================================================
        // I. WebGL Scene & Logic (Initialized Early)
        // ==========================================================
        
        const canvas = document.getElementById('webgl-canvas');
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x050505, 0.02);
        
        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 100);
        
        // üî• P-37: Start Position (Macro / Extreme Close-up)
        camera.position.set(0, 3, 2); 
        camera.lookAt(0, 0, 0);
        
        const renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true, alpha: true });
        
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.physicallyCorrectLights = true;
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.outputEncoding = THREE.sRGBEncoding;
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;

        // Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
        scene.add(ambientLight);
        
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1.5);
        directionalLight.position.set(5, 10, 7);
        directionalLight.castShadow = true;
        scene.add(directionalLight);

        const rimLight = new THREE.SpotLight(0xA08A6F, 2);
        rimLight.position.set(-5, 5, -5);
        rimLight.lookAt(0, 0, 0);
        scene.add(rimLight);

        // Object
        const geometry = new THREE.PlaneGeometry(7, 10); 
        const material = new THREE.MeshStandardMaterial({ 
            color: 0x888888, 
            side: THREE.DoubleSide,
            roughness: 0.6,
            metalness: 0.1,
        });
        const carpetPlane = new THREE.Mesh(geometry, material);
        carpetPlane.rotation.x = -Math.PI / 2; 
        
        // Initial state
        carpetPlane.receiveShadow = true;
        carpetPlane.castShadow = true;
        scene.add(carpetPlane);

        // Render Loop (Must run immediately for P-37 live background)
        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        };
        animate(); // Start immediately

        // Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });


        // ==========================================================
        // II. Preloader Logic P-37 (Textural Reveal)
        // ==========================================================
        const loaderOverlay = document.getElementById('loader-overlay');
        const loaderBar = document.getElementById('loader-bar');
        const loaderBarContainer = document.getElementById('loader-bar-container');
        const logoSplit = document.querySelector('.loader-logo-split');
        const logoLeft = document.querySelector('.logo-left');
        const logoRight = document.querySelector('.logo-right');

        // 1. –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –ª–æ–≥–æ—Ç–∏–ø–∞
        gsap.to([logoSplit, loaderBarContainer], {
            opacity: 1,
            y: 0,
            duration: 1.2,
            ease: "power2.out",
            delay: 0.2
        });

        // üî• P-37.II: –ê–Ω–∏–º–∞—Ü–∏—è –§–æ–Ω–∞ –≤–æ –í—Ä–µ–º—è –ó–∞–≥—Ä—É–∑–∫–∏
        function animateLoading() {
            // –ö–∞–º–µ—Ä–∞ –º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç—ä–µ–∑–∂–∞–µ—Ç –∏ —Å–º–µ—â–∞–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ (Annie Leibovitz)
            gsap.to(camera.position, {
                z: 4, // –û—Ç—ä–µ–∑–∂–∞–µ–º –Ω–∞–∑–∞–¥
                y: 4, // –°–º–µ—â–∞–µ–º—Å—è –≤–≤–µ—Ä—Ö
                duration: 4, // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–≤–Ω–∞ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏
                ease: "power2.inOut",
            });
            // –ö–æ–≤–µ—Ä –º–µ–¥–ª–µ–Ω–Ω–æ –≤—Ä–∞—â–∞–µ—Ç—Å—è, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—è —Ç–µ–∫—Å—Ç—É—Ä—É
            gsap.to(carpetPlane.rotation, {
                z: 0.2, 
                duration: 4, 
                ease: "power2.inOut",
            });
        }

        // 2. –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
        function startLoadingSimulation() {
            // –í–∫–ª—é—á–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å –∫–∞–Ω–≤–∞—Å–∞ —Å—Ä–∞–∑—É, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é animateLoading
            gsap.to(canvas, { opacity: 1, duration: 0.8 });
            
            animateLoading(); // –ó–∞–ø—É—Å–∫ –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏–∏
            
            gsap.to(loaderBar, {
                scaleX: 1,
                duration: 4,
                ease: "power2.inOut",
                onComplete: () => {
                    hidePreloader();
                }
            });
        }

        // 3. üî• P-37.III: –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –í—ã—Ö–æ–¥
        function hidePreloader() {
            const sections = document.querySelectorAll('.section');
            
            const tl = gsap.timeline({ defaults: { duration: 1.8, ease: "power4.out" } });

            // 1. –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –≤—ã—Ö–æ–¥ –ª–æ–≥–æ—Ç–∏–ø–∞
            tl.to(loaderBarContainer, { opacity: 0, duration: 0.3 }, 0) 
              .to(logoLeft, { 
                  x: '-100%', 
                  y: '-100%', // üî• –í–≤–µ—Ä—Ö –∏ –≤–ª–µ–≤–æ (P-37.III)
                  opacity: 0, 
                  duration: 1.5, 
                  ease: "back.inOut(1.5)" 
              }, 0.2) 
              .to(logoRight, { 
                  x: '100%', 
                  y: '100%', // üî• –í–Ω–∏–∑ –∏ –≤–ø—Ä–∞–≤–æ (P-37.III)
                  opacity: 0, 
                  duration: 1.5, 
                  ease: "back.inOut(1.5)" 
              }, 0.2)
              
            // 2. –ü–æ–ª–Ω–æ–µ —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ —Å—Ü–µ–Ω—ã –∏ –§–æ–∫—É—Å
              .to(loaderOverlay, { 
                  opacity: 0,
                  display: 'none',
                  duration: 1.2,
              }, 1.5) 
              .to(canvas, { 
                  filter: 'blur(0px)', // –ê–Ω–∏–º–∞—Ü–∏—è –§–æ–∫—É—Å–∏—Ä–æ–≤–∫–∏
                  scale: 1, 
                  duration: 2.0, 
                  ease: 'expo.inOut' 
              }, 1.2) 
              .to(camera.position, { 
                  z: 5, y: 5, // üî• –§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –∫–∞–º–µ—Ä—ã –¥–ª—è —Å–∫—Ä–æ–ª–ª–∞
                  duration: 2.5, 
                  ease: 'expo.inOut' 
              }, 1.2)
              
            // 3. Staggered Content
              .from(sections, { 
                  opacity: 0, 
                  y: 50, 
                  duration: 1.5, 
                  ease: 'expo.out', 
                  stagger: 0.1 
              }, 3.0);
        }

        window.onload = startLoadingSimulation;


        // ==========================================================
        // III. Custom Cursor
        // ==========================================================
        const cursorOuter = document.querySelector('.cursor-outer');
        const cursorInner = document.querySelector('.cursor-inner');
        
        gsap.set([cursorOuter, cursorInner], { x: -100, y: -100 });

        window.addEventListener('mousemove', (e) => {
            gsap.to(cursorInner, {
                x: e.clientX,
                y: e.clientY,
                duration: 0.1 
            });
            gsap.to(cursorOuter, {
                x: e.clientX,
                y: e.clientY,
                duration: 0.15 
            });
        });

        const targets = document.querySelectorAll('.interactive-target');
        targets.forEach(el => {
            el.addEventListener('mouseenter', () => {
                gsap.to(cursorOuter, { scale: 2, opacity: 0.3, duration: 0.2 });
            });
            el.addEventListener('mouseleave', () => {
                gsap.to(cursorOuter, { scale: 1, opacity: 1, duration: 0.2 });
            });
        });

        // ==========================================================
        // IV. ScrollTrigger
        // ==========================================================
        if (typeof ScrollTrigger !== 'undefined') {
            gsap.registerPlugin(ScrollTrigger);

            ScrollTrigger.create({
                trigger: '#section-1',
                start: 'top top',
                end: 'bottom 50%',
                pin: true,
                pinSpacing: false,
                onUpdate: (self) => {
                    gsap.to('#section-1 h1, #section-1 p', { 
                        opacity: 1 - self.progress * 1.5, 
                        y: -50 * self.progress,
                        duration: 0.1,
                        overwrite: true
                    });
                }
            });

            const tl = gsap.timeline({
                scrollTrigger: {
                    trigger: "#content",
                    start: "top top",
                    end: "bottom bottom",
                    scrub: 1 
                }
            });

            tl.to(carpetPlane.rotation, { z: Math.PI * 1, ease: "none" }, 0)
              .to(carpetPlane.position, { y: 2, ease: "none" }, 0); 
        }
    </script>
</body>
</html>